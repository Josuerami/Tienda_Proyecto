<%- include('../parciales/encabezado') %>

<section class="panel">
  <h1 class="titulo">Bienvenido a Canelitos</h1>
  <!-- Banner corregido -->
  <img class="banner" src="/uploads/banner.jpg" alt="Banner">

  <div class="grid">
    <% productos.forEach(p => { %>
      <div class="card">
        <img class="card-img" src="<%= p.ruta_imagen ? '/uploads/' + p.ruta_imagen.replace(/^.*[\\\/]/,'') : '/uploads/placeholder.png' %>" alt="<%= p.nombre %>">
        <div class="card-titulo"><%= p.nombre %></div>
        <div class="card-sub">Categoría: <%= p.nombre_categoria || 'N/A' %></div>
        <div class="card-precio">$<%= Number(p.precio).toFixed(2) %></div>
        <a class="btn" href="/producto/<%= p.id %>">Ver</a>
        <% if (rol === 'admin' || rol === 'vendedor') { %>
          <a class="btn" href="/admin/productos/editar/<%= p.id %>">Editar</a>
          <form style="display:inline-block" method="post" action="/admin/productos/eliminar" onsubmit="return confirm('¿Eliminar producto?')">
            <input type="hidden" name="producto_id" value="<%= p.id %>">
            <button class="btn btn-danger" type="submit">Eliminar</button>
          </form>
        <% } %>
      </div>
    <% }) %>
  </div>
</section>

<%- include('../parciales/pie') %>
