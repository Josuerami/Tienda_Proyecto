<%- include('../parciales/encabezado') %>

<section class="panel">
  <h2 class="titulo">Editar producto</h2>
  <form class="form" method="post" action="/admin/productos/editar/<%= producto.id %>" enctype="multipart/form-data">
    <label>Nombre</label><input class="input" type="text" name="nombre" value="<%= producto.nombre %>" required>
    <label>Descripción</label><textarea class="input" name="descripcion"><%= producto.descripcion %></textarea>
    <label>Precio</label><input class="input" type="number" step="0.01" name="precio" value="<%= producto.precio %>" required>
    <label>Categoría</label>
    <select class="input" name="categoria_id">
      <% categorias.forEach(function(c){ %>
        <option value="<%= c.id %>" <%= c.id === producto.categoria_id ? 'selected' : '' %>><%= c.nombre %></option>
      <% }) %>
    </select>
    <label>Stock</label><input class="input" type="number" name="stock" value="<%= producto.stock %>">
    <label>Marca</label><input class="input" type="text" name="marca" value="<%= producto.marca %>">
    <label>Proveedor</label><input class="input" type="text" name="proveedor" value="<%= producto.proveedor %>">
    <label>Fecha de registro</label><input class="input" type="date" name="fecha_registro" value="<%= producto.fecha_registro ? (producto.fecha_registro.toISOString ? producto.fecha_registro.toISOString().split('T')[0] : producto.fecha_registro.split('T')[0]) : '' %>" required>
    <p>Imagen actual: <%= producto.ruta_imagen ? ('/uploads/' + producto.ruta_imagen.replace(/^.*[\\\/]/,'')) : 'Sin imagen' %></p>
    <label>Nueva imagen (opcional)</label>
    <input class="input" type="file" name="imagen" accept="image/*">
    <button class="btn" type="submit">Guardar cambios</button>
  </form>

  <form method="post" action="/admin/productos/eliminar" onsubmit="return confirm('¿Eliminar producto?')">
    <input type="hidden" name="producto_id" value="<%= producto.id %>">
    <button class="btn btn-danger" type="submit">Eliminar producto</button>
  </form>
</section>

<%- include('../parciales/pie') %>